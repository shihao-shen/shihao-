---
# å½“å‰é¡µé¢å†…å®¹æ ‡é¢˜
title: AES 
# sidebar: heading
# å½“å‰é¡µé¢å›¾æ ‡
icon: note
# åˆ†ç±»
category:
    - å¯¹ç§°åŠ å¯†ç®—æ³•
    - åŠ å¯†ç®—æ³•
tag:
    - AES
sticky: false
# æ˜¯å¦æ”¶è—åœ¨åšå®¢ä¸»é¢˜çš„æ–‡ç« åˆ—è¡¨ä¸­ï¼Œå½“å¡«å…¥æ•°å­—æ—¶ï¼Œæ•°å­—è¶Šå¤§ï¼Œæ’åè¶Šé å‰ã€‚
star: false
# æ˜¯å¦å°†è¯¥æ–‡ç« æ·»åŠ è‡³æ–‡ç« åˆ—è¡¨ä¸­
article: true
# æ˜¯å¦å°†è¯¥æ–‡ç« æ·»åŠ è‡³æ—¶é—´çº¿ä¸­
timeline: true
# sidebar: heading
order: 1
date: 2022-01-06
# æµè§ˆé‡
pageview: true
---

# ğŸ“– ä»€ä¹ˆæ˜¯AESï¼Ÿ

AESï¼ˆAdvanced Encryption Standardï¼‰æ˜¯é«˜çº§åŠ å¯†æ ‡å‡†ï¼Œæ˜¯ç›®å‰ä¸–ç•Œä¸Šæœ€æµè¡Œçš„åŠ å¯†ç®—æ³•ã€‚AESçš„å‰èº«æ˜¯RijndaelåŠ å¯†ç®—æ³•ï¼Œç”±ç¾å›½å¯†ç å­¦å®¶çº¦ç‘Ÿå¤«Â·è±å› è¾¾å°”ï¼ˆJoan Daemenï¼‰å’Œè·å…°å¯†ç å­¦å®¶é˜¿å°”å¼—é›·å¾·Â·è±å› è¾¾å°”ï¼ˆVincent Rijmenï¼‰äº1997å¹´æå‡ºã€‚

2001å¹´ï¼Œç¾å›½å›½å®¶æ ‡å‡†ä¸æŠ€æœ¯ç ”ç©¶æ‰€ï¼ˆNISTï¼‰æ­£å¼å°†RijndaelåŠ å¯†ç®—æ³•ä½œä¸ºæ–°çš„é«˜çº§åŠ å¯†æ ‡å‡†ï¼Œå³AESç®—æ³•ã€‚ç”±äºAESç®—æ³•çš„é«˜å®‰å…¨æ€§å’Œå¿«é€ŸåŠ å¯†é€Ÿåº¦ï¼Œå®ƒå¾ˆå¿«å°±æˆä¸ºäº†ç›®å‰ä¸–ç•Œä¸Šæœ€æµè¡Œçš„åŠ å¯†ç®—æ³•ï¼Œå¹¶å¾—åˆ°äº†å¹¿æ³›çš„åº”ç”¨ã€‚

## ğŸ“‘ åŠ å¯†æµç¨‹

AESåŠ å¯†ç®—æ³•çš„åŸºæœ¬æµç¨‹å¦‚ä¸‹ï¼š

1. å¯†é’¥ç”Ÿæˆï¼šå¯¹äºä¸åŒçš„å¯†é’¥é•¿åº¦ï¼ŒAESç®—æ³•ä½¿ç”¨ä¸åŒçš„å¯†é’¥æ‰©å±•ç®—æ³•ã€‚
2. åˆå§‹ç½®æ¢ï¼šAESç®—æ³•å¯¹æ˜æ–‡è¿›è¡Œåˆå§‹ç½®æ¢ï¼Œå°†æ˜æ–‡åˆ†æˆè‹¥å¹²ä¸ªçŠ¶æ€å‘é‡ã€‚
3. å¯†é’¥åŠ ï¼šå°†å¯†é’¥ä¸çŠ¶æ€å‘é‡è¿›è¡Œå¼‚æˆ–è¿ç®—ã€‚
4. å­—èŠ‚æ›¿ä»£ï¼šå°†å¼‚æˆ–åçš„ç»“æœè¿›è¡Œå­—èŠ‚æ›¿ä»£ï¼Œä½¿ç”¨Sç›’è¿›è¡Œè½¬æ¢ã€‚
5. è¡Œç§»ä½ï¼šå°†è½¬æ¢åçš„ç»“æœè¿›è¡Œè¡Œç§»ä½ã€‚
6. åˆ—æ··æ·†ï¼šå°†è¡Œç§»ä½åçš„ç»“æœè¿›è¡Œåˆ—æ··æ·†ã€‚
7. å¯†é’¥åŠ ï¼šå°†ç¬¬6æ­¥çš„ç»“æœä¸å¯†é’¥è¿›è¡Œå¼‚æˆ–è¿ç®—ã€‚
8. é‡å¤æ­¥éª¤3-7ï¼šå°†ç¬¬7æ­¥çš„ç»“æœå†æ¬¡è¿›è¡Œå­—èŠ‚æ›¿ä»£ã€è¡Œç§»ä½ã€åˆ—æ··æ·†ä»¥åŠå¯†é’¥åŠ è¿ç®—ã€‚
9. æœ€ç»ˆç½®æ¢ï¼šå°†åŠ å¯†å®Œæˆçš„çŠ¶æ€å‘é‡è¿›è¡Œæœ€ç»ˆç½®æ¢ï¼Œå¾—åˆ°å¯†æ–‡ã€‚

## ğŸ“‘ åº”ç”¨åœºæ™¯

AESæ˜¯ä¸€ç§å¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œè¢«å¹¿æ³›åº”ç”¨äºæ•°æ®åŠ å¯†ã€æ•°å­—ä¿¡å°ã€æ•°æ®å®Œæ•´æ€§æ£€æŸ¥ã€è®¤è¯ç­‰æ–¹é¢ã€‚

AESçš„ä¼˜ç‚¹åœ¨äºå…¶å…·æœ‰é«˜å®‰å…¨æ€§ã€é«˜æ•ˆç‡ã€çµæ´»çš„å¯†é’¥é•¿åº¦è®¾ç½®ç­‰ç‰¹ç‚¹ã€‚

ç›¸æ¯”å…¶ä»–å¯¹ç§°åŠ å¯†ç®—æ³•ï¼ŒAESå…·æœ‰æ›´é«˜çš„å®‰å…¨æ€§å’Œæ›´é«˜çš„æ•ˆç‡ã€‚ä¾‹å¦‚ï¼Œä¸DESç›¸æ¯”ï¼ŒAESå…·æœ‰æ›´é«˜çš„å®‰å…¨æ€§ï¼Œå¹¶ä¸”åœ¨è®¡ç®—æœºä¸Šçš„è¿è¡Œé€Ÿåº¦ä¹Ÿè¦å¿«å¾—å¤šã€‚

åœ¨å®é™…åº”ç”¨ä¸­ï¼ŒAESå¹¿æ³›åº”ç”¨äºå„ç§ä¿¡æ¯å®‰å…¨é¢†åŸŸï¼Œå¦‚åŠ å¯†ç”µå­é‚®ä»¶ã€æ–‡ä»¶åŠ å¯†ã€åŠ å¯†é€šä¿¡ç­‰ã€‚åŒæ—¶ï¼ŒAESçš„å®‰å…¨æ€§å’Œæ•ˆç‡ä¹Ÿå¾—åˆ°äº†å¹¿æ³›è®¤å¯ï¼Œå·²ç»æˆä¸ºç›®å‰ä¸»æµçš„å¯¹ç§°åŠ å¯†ç®—æ³•ä¹‹ä¸€5

## ğŸ“‘ ä»£ç å®ç°

python åœ¨ Windowsä¸‹ä½¿ç”¨AESæ—¶è¦å®‰è£…çš„æ˜¯pycryptodome æ¨¡å—

> pip install pycryptodome

python åœ¨ Linuxä¸‹ä½¿ç”¨AESæ—¶è¦å®‰è£…çš„æ˜¯pycryptoæ¨¡å—

> pip install pycrypto

```python
from Crypto.Cipher import AES

def encrypt(key, plaintext):
    cipher = AES.new(key, AES.MODE_EAX)
    ciphertext, tag = cipher.encrypt_and_digest(plaintext)
    return [cipher.nonce, tag, ciphertext]

def decrypt(key, nonce, tag, ciphertext):
    cipher = AES.new(key, AES.MODE_EAX, nonce)
    plaintext = cipher.decrypt_and_verify(ciphertext, tag)
    return plaintext

key = b'Sixteen byte key'
plaintext = b'Attack at dawn'

encrypted_data = encrypt(key, plaintext)
decrypted_data = decrypt(key, *encrypted_data)

assert decrypted_data == plaintext
```

åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œencryptå‡½æ•°æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼šå¯†é’¥å’Œæ˜æ–‡ã€‚å®ƒä½¿ç”¨AES.newå‡½æ•°åˆ›å»ºä¸€ä¸ªAESå¯¹è±¡ï¼Œå¹¶ä½¿ç”¨encrypt_and_digestå‡½æ•°å¯¹æ˜æ–‡è¿›è¡ŒåŠ å¯†å’Œè®¡ç®—æ‘˜è¦ã€‚æœ€åï¼Œå®ƒè¿”å›ä¸€ä¸ªåŒ…å«åŠ å¯†ç»“æœçš„åˆ—è¡¨ã€‚

decryptå‡½æ•°æ¥æ”¶å››ä¸ªå‚æ•°ï¼šå¯†é’¥ï¼Œnonceï¼Œtagå’Œå¯†æ–‡ã€‚å®ƒä½¿ç”¨AES.newå‡½æ•°åˆ›å»ºä¸€ä¸ªAESå¯¹è±¡ï¼Œå¹¶ä½¿ç”¨decrypt_and_verifyå‡½æ•°å¯¹å¯†æ–‡è¿›è¡Œè§£å¯†å’ŒéªŒè¯